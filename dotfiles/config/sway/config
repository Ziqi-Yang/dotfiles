# /etc/sway/config
# requirements: swaybg, swayidle, swaylock
set $mod Mod4
set $mod_shift $mod+Shift
set $left h
set $down j
set $up k
set $right l
set $term kitty
set $menu rofi -show combi -show-icons

# fix issue https://github.com/swaywm/sway/wiki#gtk-applications-take-20-seconds-to-start
exec dbus-update-activation-environment --systemd DISPLAY WAYLAND_DISPLAY SWAYSOCK

## autostart
exec ~/.config/sway/autostart.sh

## Idle configuration
exec swayidle -w \
		 timeout 600 'swaylock' \
		 timeout 300 'swaymsg "output * power off"' resume 'swaymsg "output * power on"' \
		 before-sleep 'swaylock'

## Input
#
input "type:keyboard" {
    xkb_layout us
    repeat_delay 250
    repeat_rate 30
}

input "type:touchpad" {
    tap enabled
    # disable while typing
    dwt enabled
    natural_scroll disabled
    pointer_accel 0.2
}

## UI
# TokyoNight theme
# Property Name             Border  BG      Text    Indicator Child-border
client.focused              #bdc3c7 #000000 #000000 
client.unfocused            #2c3e50aa #000000 #000000

## Monitor
### use command 'swaymsg -t get_outputs' to see all the output devices

### monitors configuration (generated by 'nwg-display')
include ~/.config/sway/outputs
output "eDP-1" bg ~/Pictures/background/21.png fill
output "HDMI-A-1" bg ~/Pictures/Attack_on_Titan/S2-2.jpg fill

## by making the two monitor overlapping, we can sync mouse and floating window
# use 'nwg-display' to scale the screen
# output eDP-1 pos 0 0 
# output HDMI-A-1 pos 0 0 

### HDMI workspace settings
# the default target monitor of workspace 2 is HDMI-A-1 (if connected)
include ~/.config/sway/workspaces

# disable(hide) title bar
default_border none
default_floating_border none
font pango:monospace 0
titlebar_padding 3
titlebar_border_thickness 0
# smart gaps
gaps inner 10
smart_borders on
smart_gaps on

## Window Rules
# works for alacritty --class floating, but not for 'kitty --class floating'
for_window [app_id="floating"] floating enable
for_window [app_id="fullscreen"] fullscreen enable
assign [app_id="^firefoxdeveloperedition$"] workspace 3

## Keybindings
#
# @ System
#
bindsym $mod+Return exec $term
bindsym $mod+Space exec $menu
bindsym $mod+w kill
floating_modifier $mod normal
bindsym $mod_shift+c reload
bindsym $mod_shift+e exec swaynag -t warning -m 'You pressed the exit shortcut. Do you really want to exit sway? This will end your Wayland session.' -B 'Yes, exit sway' 'swaymsg exit'

bindsym --locked XF86AudioMute exec pamixer -t && ~/myBin/volume_notify
bindsym --locked XF86AudioLowerVolume exec pamixer -d 5 && ~/myBin/volume_notify
bindsym --locked XF86AudioRaiseVolume exec pamixer -i 5 && ~/myBin/volume_notify
bindsym --locked XF86MonBrightnessUp exec brightnessctl s 5%+ && ~/myBin/brightness_notify
bindsym --locked XF86MonBrightnessDown exec brightnessctl s 5%- && ~/myBin/brightness_notify
# bindsym --locked XF86PowerOff exec ~/myBin/toggle_screen
bindsym --locked XF86PowerOff exec systemctl suspend
bindsym --locked $mod_shift+q exec swaylock

#
# @ Movement:
#
# Move your focus around
bindsym $mod+$left focus left
bindsym $mod+$down focus down
bindsym $mod+$up focus up
bindsym $mod+$right focus right
# Move the focused window with the same, but add Shift
bindsym $mod+Shift+$left move left
bindsym $mod+Shift+$down move down
bindsym $mod+Shift+$up move up
bindsym $mod+Shift+$right move right

bindsym Alt+Tab focus prev

#
# @ Workspaces:
#
# Switch to workspace
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+6 workspace number 6
bindsym $mod+7 workspace number 7
bindsym $mod+8 workspace number 8
bindsym $mod+9 workspace number 9
bindsym $mod+0 workspace number 10
bindsym $mod+tab workspace back_and_forth
# Move focused container to workspace
bindsym $mod+Shift+1 move container to workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4
bindsym $mod+Shift+5 move container to workspace number 5
bindsym $mod+Shift+6 move container to workspace number 6
bindsym $mod+Shift+7 move container to workspace number 7
bindsym $mod+Shift+8 move container to workspace number 8
bindsym $mod+Shift+9 move container to workspace number 9
bindsym $mod+Shift+0 move container to workspace number 10

#
# @ Layout stuff:
#
# Switch the current container between different layout styles
# bindsym $mod_shift+s layout stacking
bindsym $mod_shift+t layout tabbed
bindsym $mod+s layout toggle split
bindsym $mod+f fullscreen
bindsym $mod_shift+f floating toggle
# bindsym $mod+a focus parent # TODO don't really know its function

#
# @ Scratchpad:
#
bindsym $mod_shift+period move scratchpad
bindsym $mod+period scratchpad show

#
# @ Resizing containers:
#
mode "resize" {
    bindsym $left resize shrink width 20px
    bindsym $down resize grow height 20px
    bindsym $up resize shrink height 20px
    bindsym $right resize grow width 20px

    # Return to default mode
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+r mode "resize"

#
# @ Utility
#
# application launcher (fullscreen)
bindsym $mod+x exec alacritty --class floating
bindsym $mod+a exec rofi -no-lazy-grab -show drun -theme ~/.local/share/rofi/themes/launchpad.rasi -show-icons 
# emoji
bindsym $mod+e exec ~/myBin/emoji_selector 
# translator
bindsym $mod+t exec kitty --class floating -e '/bin/fish' -c 'source ~/.config/fish/functions/t.fish; t $(wl-paste); read'
# calc
bindsym $mod+c exec rofi -show calc -modi calc -theme spotlight -no-show-match -no-sort -calc-command "echo -n '\{result\}' | xclip -sel clip; xdotool type --clearmodifiers '\{result\}'"
# clipboard, currently rofi wayland fork have demnu issues
bindsym $mod+v exec clipman pick -t wofi 
# for some application doesn't support paste in wayland
bindsym $mod_shift+v exec wtype $(wl-paste)
# screenshot
bindsym $mod_shift+s exec grim -g "$(slurp)" - | swappy -f - 

## Status Bar
# use waybar instead of standard swaybar
bar swaybar_command waybar

include /etc/sway/config.d/*
